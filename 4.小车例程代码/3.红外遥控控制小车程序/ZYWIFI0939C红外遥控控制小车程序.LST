C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:42:41 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE ZYWIFI0939C_ңؿ_С
OBJECT MODULE PLACED IN ZYWIFI0939CңؿС.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ZYWIFI0939CңؿС.C BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /**********************ZYWIFI0939C-WIFIʵ************************
   2          *  ƽ̨ZYWIFI0939C-WIFI + Keil U4 + STC89C52
   3          *  ƣZY-1Сο
   4          *  ˾ƽ豸޹˾
   5          *  Աhttps://hnzyrobot1688.taobao.com/     
   6          *  վwww.hnzhiyu.cn 
   7          *  д˾зһ
   8          *  ڣ2015-1-15
   9          *  :ܳQQ:261339276
  10          *  :11.0592MHZ
  11          *  ˵ѿԴṩԴ
  12          *  ӲãҪԼʵ
  13          *  ʹ˵IOԼöŰӸģ飬Լ޸ĸģIO
  14          *  Ƶ̳̣СѧϰCϸƵ̳̣ͳһ
  15             صʾֻοṩ֧֣Լоա
  16            ZYWIFI0939WIFIܻ˶Ű߽߷һܲջС
  17             
  18          ******************************************************************/   
  19          
  20          #include <reg52.h>                                  //51Ƭصͷļ
  21          #include <intrins.h>
  22          #define uint    unsigned int                          //ض޷
  23          #define uchar   unsigned char                         //ض޷ַ
  24          
  25          uchar code  LedShowData[]={0x03,0x9F,0x25,0x0D,0x99,  //ʾ
  26                                      0x49,0x41,0x1F,0x01,0x19};//0,1,2,3,4,5,6,7,8,9
  27          
  28          uchar code  RecvData[]={0x19,0x46,0x15,0x44,0x43,0x40,0x0D,0x0E,0x00,0x0F};
  29          
  30          uchar IRCOM[7];
  31          
  32          static unsigned int LedFlash;                         //Ƶʼ
  33          
  34          unsigned char RunFlag=0;                              //б־λ
  35          bit EnableLight=0;                                    //ָʾʹλ
  36          
  37          /*************״ָ̬ʾƶ*************/
  38          sbit S1=P3^2;                                         //S1˿
  39                                                   
  40          /*************ɵƶ˿ڶ***********/
  41          sbit M1A=P1^2;                                        //1˿
  42          sbit M1B=P1^3;                                        //1˿
  43          sbit M2A=P1^4;                                        //2˿
  44          sbit M2B=P1^5;                                        //2˿
  45          
  46          sbit SB1=P2^3;                                        //˿
  47          /*********ɻͲ,,.˿ڶ**/
  48          sbit IRIN=P3^3;                                       //ն˿
  49          /*********ɺն˿ڵĶ*************/
  50          #define ShowPort P0                                   //ʾ˿
  51          
  52          extern void ControlCar(uchar CarType);                //Сӳ
  53          
  54          void delayms(unsigned char x)                         //0.14mSʱ
  55          {
C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:42:41 PAGE 2   

  56   1        unsigned char i;                                    //ʱ
  57   1        while(x--)                                          //ʱʱѭ
  58   1        {
  59   2          for (i = 0; i<13; i++) {}                         //14mSʱ
  60   2        }
  61   1      }
  62          
  63          void Delay1ms(unsigned int i) 
  64          { 
  65   1      unsigned char j,k; 
  66   1      do{ 
  67   2        j = 10; 
  68   2        do{ 
  69   3         k = 50; 
  70   3         do{ 
  71   4          _nop_(); 
  72   4         }while(--k);     
  73   3        }while(--j); 
  74   2      }while(--i); 
  75   1      
  76   1      } 
  77          void Delay()                                          //ʱӳ
  78          { uint DelayTime=30000;                               //ʱʱ
  79   1        while(DelayTime--);                                 //ʼʱѭ
  80   1        return;                                             //ӳ򷵻
  81   1      }
  82          
  83          void tingzhi()
  84          {
  85   1         M1A=0;                                   //M1A˳ʼΪ0
  86   1         M1B=0;                                   //M1B˳ʼΪ0
  87   1         M2A=0;                                   //M2A˳ʼΪ0
  88   1         M2B=0;
  89   1      
  90   1      }
  91          
  92          void qianjin()
  93          {
  94   1         M1A=1;                                   
  95   1         M1B=0;                                   
  96   1         M2A=1;                                   
  97   1         M2B=0;
  98   1      }
  99          
 100          void houtui()
 101          {
 102   1         M1A=0;                                   
 103   1         M1B=1;                                   
 104   1         M2A=0;                                   
 105   1         M2B=1;
 106   1      }
 107          
 108          void youzhuan()
 109          {
 110   1         M1A=1;                                   
 111   1         M1B=0;                                   
 112   1         M2A=0;                                   
 113   1         M2B=1;
 114   1      
 115   1      }
 116          
 117          void zuozhuan()
C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:42:41 PAGE 3   

 118          {
 119   1         M1A=0;                                   
 120   1         M1B=1;                                   
 121   1         M2A=1;                                   
 122   1         M2B=0;
 123   1      
 124   1      }
 125          
 126          void ControlCar(unsigned char ConType)    //ӳ
 127          {
 128   1       
 129   1        tingzhi();
 130   1       switch(ConType)                          //жû趨ʽ
 131   1       {
 132   2        case 1:  //ǰ                         //жûǷѡʽ1
 133   2        { 
 134   3          
 135   3              tingzhi();                                                    //ǰ֮ǰ ֹͣһʱ  ֹѹ ϵͳλ
 136   3               Delay1ms(240);
 137   3              qianjin();
 138   3              ShowPort=LedShowData[1];
 139   3          break;
 140   3        }
 141   2        case 2: //                              //жûǷѡʽ2
 142   2        { 
 143   3          tingzhi();                                                        //֮ǰ ֹͣһʱ  ֹѹ ϵͳλ
 144   3                Delay1ms(240);
 145   3      //      LeftLed = 1 ;    
 146   3              houtui();
 147   3              ShowPort=LedShowData[2];                                //M2ת
 148   3          break;
 149   3        }
 150   2        case 3: //ת                              //жûǷѡʽ3
 151   2        { 
 152   3          tingzhi();                                                            //ת֮ǰ ֹͣһʱ  ֹѹ ϵͳλ
 153   3               Delay1ms(240); 
 154   3              zuozhuan(); 
 155   3              ShowPort=LedShowData[3];                              //M2ת
 156   3              break;
 157   3        }
 158   2        case 4: //ת                              //жûǷѡʽ4
 159   2        { 
 160   3          tingzhi();                                                            //ת֮ǰ ֹͣһʱ  ֹѹ ϵͳλ
 161   3                Delay1ms(240);
 162   3              youzhuan();                                //M1ת
 163   3          ShowPort=LedShowData[4];                                      //M2ת
 164   3              break;
 165   3        }
 166   2        case 5: //ֹͣ                          //жûǷѡʽ8
 167   2        {
 168   3          tingzhi();
 169   3              ShowPort=LedShowData[0]; 
 170   3              break; 
 171   3                                            //˳ǰѡ
 172   3        }
 173   2       }
 174   1      }
 175          
 176          void IR_IN() interrupt 2 using 0                      //INT2ⲿжϺ
 177          {
 178   1        unsigned char j,k,N=0;                              //ʱձ
 179   1         
C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:42:41 PAGE 4   

 180   1        EX1 = 0;                                            //رⲿж,ֹźŵ   
 181   1        delayms(15);                                        //ʱʱ䣬к
 182   1        if (IRIN==1)                                        //жϺźǷʧ
 183   1        {  
 184   2           EX1 =1;                                          //ⲿжϿ
 185   2               return;                                          //
 186   2        } 
 187   1                                 
 188   1        while (!IRIN)                                       //IRΪߵƽ9msǰ͵ƽźš
 189   1        {
 190   2            delayms(1);                                     //ʱȴ
 191   2        }
 192   1      
 193   1        for (j=0;j<4;j++)                                   //ɼң
 194   1        { 
 195   2          for (k=0;k<8;k++)                                 //ִβɼ8λ
 196   2          {
 197   3             while (IRIN)                                   // IR Ϊ͵ƽ4.5msǰߵƽźš
 198   3             {
 199   4               delayms(1);                                  //ʱȴ
 200   4             }
 201   3             
 202   3             while (!IRIN)                                  // IR Ϊߵƽ
 203   3             {
 204   4               delayms(1);                                  //ʱȴ
 205   4             }
 206   3         
 207   3             while (IRIN)                                   //IRߵƽʱ
 208   3             {
 209   4               delayms(1);                                  //ʱȴ
 210   4               N++;                                         //Ӽ
 211   4               if (N>=30)                                   //жϼۼֵ
 212   4                   { 
 213   5                 EX1=1;                                     //ⲿжϹ
 214   5                     return;                                    //
 215   5               }                   
 216   4             }
 217   3                                             
 218   3            IRCOM[j]=IRCOM[j] >> 1;                         //λƲԶ
 219   3           
 220   3            if (N>=8)                                       //жݳ 
 221   3            {
 222   4               IRCOM[j] = IRCOM[j] | 0x80;                  //λ1
 223   4            } 
 224   3            N=0;                                            //λ¼
 225   3          }
 226   2        }
 227   1         
 228   1        if (IRCOM[2]!=~IRCOM[3])                            //жϵַǷͬ
 229   1        { 
 230   2           EX1=1;                                           //ⲿж
 231   2           return;                                          //
 232   2        }
 233   1      
 234   1        for(j=0;j<10;j++)                                   //ѭм
 235   1         {
 236   2            if(IRCOM[2]==RecvData[j])                       //мλӦ
 237   2            {
 238   3              ControlCar(j);                                          //ʾӦ
 239   3            }
 240   2         }
 241   1         
C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:42:41 PAGE 5   

 242   1         
 243   1         EX1 = 1;                                           //ⲿжϿ 
 244   1      } 
 245          
 246          
 247          
 248          void main(void)                                       //
 249          {
 250   1       bit ExeFlag=0;                                       //ִλ
 251   1       
 252   1       LedFlash=3000;                                       //ݽгʼ
 253   1       EX1=1;                                               //ͬ⿪ⲿж1
 254   1       IT1=1;                                               //趨ⲿж1ΪͱԵ
 255   1       EA=1;                                                //жϿ
 256   1       ShowPort=LedShowData[0];                             //ʾ0
 257   1      while(1)                                              //ѭ
 258   1       {
 259   2         
 260   2         Delay();                                           //ʱ
 261   2        // RunStopState=~RunStopState;                        //ָʾ״̬ת
 262   2        
 263   2       }
 264   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    386    ----
   CONSTANT SIZE    =     20    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
