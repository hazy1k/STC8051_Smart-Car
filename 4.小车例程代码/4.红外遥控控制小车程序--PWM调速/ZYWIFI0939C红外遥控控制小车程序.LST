C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:49:26 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE ZYWIFI0939C_ңؿ_С
OBJECT MODULE PLACED IN ZYWIFI0939CңؿС.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ZYWIFI0939CңؿС.C BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /**********************ZYWIFI0939C-WIFIʵ************************
   2          *  ƽ̨ZYWIFI0939C-WIFI + Keil U4 + STC89C52
   3          *  ƣZY-1Сο
   4          *  ˾ƽ豸޹˾
   5          *  Աhttps://hnzyrobot1688.taobao.com/     
   6          *  վwww.hnzhiyu.cn 
   7          *  д˾зһ
   8          *  ڣ2015-1-15
   9          *  :ܳQQ:261339276
  10          *  :11.0592MHZ
  11          *  ˵ѿԴṩԴ
  12          *  ӲãҪԼʵ
  13          *  ʹ˵IOԼöŰӸģ飬Լ޸ĸģIO
  14          *  Ƶ̳̣СѧϰCϸƵ̳̣ͳһ
  15             صʾֻοṩ֧֣Լоա
  16            ZYWIFI0939WIFIܻ˶Ű߽߷һܲջС
  17            J3 ӵʵ P4                                         J4 ʵ P7ӿ 
  18             IN1--ӵ--ʵϵP1.2                   IN5--ӵ--ʵϵP2.1
  19             IN2--ӵ--ʵϵP1.3                   IN6--ӵ--ʵϵP2.0
  20             EN1--ӵ--ʵϵP1.4
  21             EN2--ӵ--ʵϵP1.5
  22             IN3--ӵ--ʵϵP1.6
  23             IN4--ӵ--ʵϵP1.7
  24             
  25             J5 ʵP3ӿ
  26             OUT1--ӵ--ʵϵP3.2                     OUT3--ӵ--ʵϵP3.4
  27             OUT2--ӵ--ʵϵP3.3                                     OUT4--ӵ--ʵϵP3.5
  28             VCC-- ӵ--ʵϵVCC                                      GND--ӵ--ʵϵGND
  29           /******************************************************************/   
  30          #include<AT89X52.H>                   //51ƬͷļڲиּĴ
  31          #include <intrins.h>
  32          #include <ZY-4WD_PWM.H>           //ZY-1СIOڶȺ
  33          #define uint    unsigned int                          //ض޷
  34          #define uchar   unsigned char                         //ض޷ַ
  35          
  36          uchar code  LedShowData[]={0x03,0x9F,0x25,0x0D,0x99,  //ʾ
  37                                      0x49,0x41,0x1F,0x01,0x19};//0,1,2,3,4,5,6,7,8,9
  38          
  39          uchar code  RecvData[]={0x19,0x46,0x15,0x44,0x43,0x40,0x0D,0x0E,0x00,0x0F};
  40          
  41          uchar IRCOM[7];
  42          unsigned char RunFlag=0;                              //б־λ
  43          bit EnableLight=0;                                    //ָʾʹλ
  44          
  45          /*************״ָ̬ʾƶ*************/
  46          sbit S1=P3^2;                                         //S1˿
  47          sbit S2=P3^4;                                         //S2˿
  48          /*************ɰ˿ڵĶ*************/       
  49          sbit LeftLed=P2^0;                                    //ǰָʾƶ˿
  50          sbit RightLed=P0^7;                                   //ǰҲָʾƶ˿
  51          
  52          /*************ɺ̽ͷ˿ڶ***********/
  53          sbit M1A=P1^2;                                        //1˿
  54          sbit M1B=P1^3;                                        //1˿
  55          sbit M2A=P1^6;                                        //2˿
C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:49:26 PAGE 2   

  56          sbit M2B=P1^7;                                        //2˿
  57          
  58          sbit SB1=P2^3;                                        //˿
  59          /*********ɻͲ,,.˿ڶ**/
  60          sbit IRIN=P3^3;                                       //ն˿
  61          /*********ɺն˿ڵĶ*************/
  62          #define ShowPort P0                                   //ʾ˿
  63          
  64          extern void ControlCar(uchar CarType);                //Сӳ
  65          
  66          void delayms(unsigned char x)                         //0.14mSʱ
  67          {
  68   1        unsigned char i;                                    //ʱ
  69   1        while(x--)                                          //ʱʱѭ
  70   1        {
  71   2          for (i = 0; i<13; i++) {}                         //14mSʱ
  72   2        }
  73   1      }
  74          
  75          void Delay1ms(unsigned int i) 
  76          { 
  77   1      unsigned char j,k; 
  78   1      do{ 
  79   2        j = 10; 
  80   2        do{ 
  81   3         k = 50; 
  82   3         do{ 
  83   4          _nop_(); 
  84   4         }while(--k);     
  85   3        }while(--j); 
  86   2      }while(--i); 
  87   1      
  88   1      } 
  89          void Delay()                                          //ʱӳ
  90          { uint DelayTime=30000;                               //ʱʱ
  91   1        while(DelayTime--);                                 //ʼʱѭ
  92   1        return;                                             //ӳ򷵻
  93   1      }
  94          
  95          
  96          void ControlCar(unsigned char ConType)    //ӳ
  97          {
  98   1       
  99   1        stop(); //ֹͣ
 100   1        
 101   1       switch(ConType)                          //жû趨ʽ
 102   1       {
 103   2        case 1:  //ǰ                         //жûǷѡʽ1
 104   2        { 
 105   3          
 106   3               stop(); //ֹͣ                                               //ǰ֮ǰ ֹͣһʱ  ֹѹ ϵͳλ
 107   3               Delay1ms(240);
 108   3              LeftLed = 0 ;
 109   3              run();   //ǰ
 110   3              ShowPort=LedShowData[1];
 111   3          break;
 112   3        }
 113   2        case 2: //                              //жûǷѡʽ2
 114   2        { 
 115   3           stop(); //ֹͣ                                                           //֮ǰ ֹͣһʱ  ֹѹ ϵͳ
             -λ
 116   3                Delay1ms(240);
C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:49:26 PAGE 3   

 117   3              LeftLed = 1 ;    
 118   3               backrun();
 119   3              ShowPort=LedShowData[2];                                //M2ת
 120   3          break;
 121   3        }
 122   2        case 3: //ת                         //жûǷѡʽ3
 123   2        { 
 124   3           stop(); //ֹͣ                             //ת֮ǰ ֹͣһʱ  ֹѹ ϵͳλ
 125   3               Delay1ms(240); 
 126   3               leftrun();
 127   3              ShowPort=LedShowData[3];                    
 128   3              break;
 129   3        }
 130   2        case 4: //ת                              //жûǷѡʽ4
 131   2        { 
 132   3          stop(); //ֹͣ              //ת֮ǰ ֹͣһʱ  ֹѹ ϵͳλ
 133   3                Delay1ms(240);
 134   3               rightrun();     //Сת                                //M1ת
 135   3          ShowPort=LedShowData[4];                                      //M2ת
 136   3              break;
 137   3        }
 138   2        case 5: //ֹͣ                          //жûǷѡʽ8
 139   2        {
 140   3          stop(); //ֹͣ      
 141   3              ShowPort=LedShowData[0]; 
 142   3              break; 
 143   3                                            //˳ǰѡ
 144   3        }
 145   2       }
 146   1      }
 147          
 148          void IR_IN() interrupt 2 using 0                      //INT2ⲿжϺ
 149          {
 150   1        unsigned char j,k,N=0;                              //ʱձ
 151   1         
 152   1        EX1 = 0;                                            //رⲿж,ֹźŵ   
 153   1        delayms(15);                                        //ʱʱ䣬к
 154   1        if (IRIN==1)                                        //жϺźǷʧ
 155   1        {  
 156   2           EX1 =1;                                          //ⲿжϿ
 157   2               return;                                          //
 158   2        } 
 159   1                                 
 160   1        while (!IRIN)                                       //IRΪߵƽ9msǰ͵ƽźš
 161   1        {
 162   2            delayms(1);                                     //ʱȴ
 163   2        }
 164   1      
 165   1        for (j=0;j<4;j++)                                   //ɼң
 166   1        { 
 167   2          for (k=0;k<8;k++)                                 //ִβɼ8λ
 168   2          {
 169   3             while (IRIN)                                   // IR Ϊ͵ƽ4.5msǰߵƽźš
 170   3             {
 171   4               delayms(1);                                  //ʱȴ
 172   4             }
 173   3             
 174   3             while (!IRIN)                                  // IR Ϊߵƽ
 175   3             {
 176   4               delayms(1);                                  //ʱȴ
 177   4             }
 178   3         
C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:49:26 PAGE 4   

 179   3             while (IRIN)                                   //IRߵƽʱ
 180   3             {
 181   4               delayms(1);                                  //ʱȴ
 182   4               N++;                                         //Ӽ
 183   4               if (N>=30)                                   //жϼۼֵ
 184   4                   { 
 185   5                 EX1=1;                                     //ⲿжϹ
 186   5                     return;                                    //
 187   5               }                   
 188   4             }
 189   3                                             
 190   3            IRCOM[j]=IRCOM[j] >> 1;                         //λƲԶ
 191   3           
 192   3            if (N>=8)                                       //жݳ 
 193   3            {
 194   4               IRCOM[j] = IRCOM[j] | 0x80;                  //λ1
 195   4            } 
 196   3            N=0;                                            //λ¼
 197   3          }
 198   2        }
 199   1         
 200   1        if (IRCOM[2]!=~IRCOM[3])                            //жϵַǷͬ
 201   1        { 
 202   2           EX1=1;                                           //ⲿж
 203   2           return;                                          //
 204   2        }
 205   1      
 206   1        for(j=0;j<10;j++)                                   //ѭм
 207   1         {
 208   2            if(IRCOM[2]==RecvData[j])                       //мλӦ
 209   2            {
 210   3              ControlCar(j);                                          //ʾӦ
 211   3            }
 212   2         }
 213   1         
 214   1         EX1 = 1;                                           //ⲿжϿ 
 215   1      } 
 216          
 217          void main(void)                                       //
 218          {
 219   1       bit ExeFlag=0;                                       //ִλ
 220   1       EX1=1;                                               //ͬ⿪ⲿж1
 221   1       IT1=1;                                               //趨ⲿж1ΪͱԵ
 222   1       EA=1; 
 223   1       TMOD=0X01;
 224   1       TH0= 0XFc;               //1msʱ
 225   1       TL0= 0X18;
 226   1       TR0= 1;
 227   1        ET0= 1;
 228   1       ShowPort=LedShowData[0];                             //ʾ0
 229   1      while(1)                                              //ѭ
 230   1       {   
 231   2         Delay();                                           //ʱ  
 232   2       }
 233   1      }
 234          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    546    ----
   CONSTANT SIZE    =     20    ----
   XDATA SIZE       =   ----    ----
C51 COMPILER V9.00   ZYWIFI0939C_ңؿ_С                                       01/20/2016 16:49:26 PAGE 5   

   PDATA SIZE       =   ----    ----
   DATA SIZE        =     14       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
